<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui">

	<p:dialog widgetVar="varRepresentante" modal="true" id="popupRepresentante" resizable="false"
				width="800" styleClass="card">	
			<f:facet name="header">
		        Representante Legal
	        </f:facet>	
	        	
			<h:form name="frmRepresentante">
				<p:messages globalOnly="true" ajaxRendered="true"
					showDetail="true" showSummary="true">
					<p:autoUpdate />
				</p:messages>
				<p:outputPanel id="panelRepresentante">
					<h:panelGrid columns="3" columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2"  layout="grid" styleClass="ui-fluid card"> 
						<p:outputLabel for="cedRepresentante" value="Cedula" />
						<p:inputText id="cedRepresentante"
							value="#{studentController.representante.idNumber}" required="true"
							requiredMessage="Campo obligatorio" >
							<p:ajax listener="#{studentController.buscarCustodianByCedula}" update="panelRepresentante" />
						</p:inputText>
						<p:message for="cedRepresentante" />

						<p:outputLabel for="nombreRepresentante" value="Nombres:" />
						<p:inputText id="nombreRepresentante"
							value="#{studentController.representante.firstName}"
							onkeyup="value=value.toUpperCase()" maxlength="50" required="true"
							requiredMessage="Campo obligatorio" />
						<p:message for="nombreRepresentante" />

						<p:outputLabel for="apeRepresentante" value="Apellidos:" />
						<p:inputText id="apeRepresentante"
							value="#{studentController.representante.lastName}"
							onkeyup="value=value.toUpperCase()"  maxlength="50" required="true"
							requiredMessage="Campo obligatorio" />
						<p:message for="apeRepresentante" />
						
						<p:outputLabel for="lugtraRepresentante" value="Lugar de trabajo:" />
						<p:inputText id="lugtraRepresentante"
							value="#{studentController.representante.custLugTrabajo}"
							onkeyup="value=value.toUpperCase()"  maxlength="100" required="true"
							requiredMessage="Campo obligatorio" />
						<p:message for="lugtraRepresentante" />
						
						<p:outputLabel for="dirtraRepresentante" value="DirecciÃ³n del trabajo:" />
						<p:inputText id="dirtraRepresentante"
							value="#{studentController.representante.custDirTrabajo}"
							onkeyup="value=value.toUpperCase()"  maxlength="150" required="true"
							requiredMessage="Campo obligatorio" />
						<p:message for="dirtraRepresentante" />
						
						<p:outputLabel for="telRepresentante" value="TelÃ©fono:" />
						<p:inputText id="telRepresentante"
							value="#{studentController.representante.custTelefono}"
							onkeyup="value=value.toUpperCase()"  maxlength="15" required="true"
							requiredMessage="Campo obligatorio" />
						<p:message for="telRepresentante" />
						
						<p:outputLabel for="celRepresentante" value="Celular:" />
						<p:inputText id="celRepresentante"
							value="#{studentController.representante.custCelular}"
							onkeyup="value=value.toUpperCase()"  maxlength="15" required="true"
							requiredMessage="Campo obligatorio" />
						<p:message for="celRepresentante" />
						
						<p:outputLabel value="Parentesco: "/>
		              	<p:selectOneMenu value="#{studentController.representante.custParent}" style="width: 130px;"  id="prntRep" required="true" requiredMessage="Cmapo requerido">
			                <f:selectItem itemLabel="#{msg['mensaje.seleccione']}" itemValue="#{null}" noSelectionOption="true" />
			                <f:selectItems value="#{studentController.parentesco}" var="prnts" itemLabel="#{prnts.descripcion}" itemValue="#{prnts.codigo}"/>	                
		              	</p:selectOneMenu>
		              	<p:message for="prntRep"/>	
		              	
	              	 	<p:outputLabel value=""/>                  
	            		  
            		  	<p:outputPanel id="pnlRepFoto"><img src="data:image/png;base64, #{studentController.custodianPic}" alt="" style="border: 10px ridge #c2dfef;" 
	            		  		width="120" height="130"/></p:outputPanel>
            		  	<p:outputLabel value=""/> 
	            		  			 
            		  	<p:outputLabel value="Foto:"/>
	                  	<p:fileUpload value="#{studentController.custodianPhoto}" mode="advanced" id="custParent" update="pnlRepFoto" auto="true" style="width: 120px;" 
		                  				allowTypes="/(\.|\/)(gif|jpe?g|png)$/"  fileUploadListener="#{studentController.changeRepresentantePhoto}"
		                  				label="Escoger" sizeLimit="100000"  process="panelRepresentante"/>
	                  	<p:message for="custParent"/>
		              						
					</h:panelGrid>
					<p:separator />
					<p:outputPanel style="text-align: center;">
						<p:column style="text-align: center;" >
							<p:commandButton action="#{studentController.addCustodian()}" rendered="#{(studentController.saveCustodian == 'S')}"
								value="Guardar"  update="panelRepresentante, :frmPrincipal:tblRepresentante" styleClass="btn-info"
								oncomplete="if (args &amp;&amp; !args.validationFailed) PF('varRepresentante').hide()" />
								
							<p:commandButton action="#{studentController.updateCustodian()}" rendered="#{(studentController.saveCustodian == 'E')}"
								value="Actualizar"  update="panelRepresentante, :frmPrincipal:tblRepresentante" styleClass="btn-info"
								oncomplete="if (args &amp;&amp; !args.validationFailed) PF('varRepresentante').hide()" />	
								
							<p:commandButton value="Cancelar"
								immediate="true"
								oncomplete="PF('varRepresentante').hide()" />
						</p:column>
					</p:outputPanel>
				</p:outputPanel>
			 </h:form>	
		</p:dialog>
</html>